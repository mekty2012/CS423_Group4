;; gorilla-repl.fileformat = 1

;; **
;;; # Result
;;; 
;;; This file analyzes result data.
;; **

;; @@
(ns moe.result
  (:require [gorilla-plot.core]
            [clojure.core.matrix
             :refer [matrix diagonal-matrix to-nested-vectors div ecount add]]
            [clojure.core.matrix.operators]
            [clojure.core.matrix.linear]
            [clojure.string]
            [moe.gaussian :refer :all]
            [moe.batchreader :refer :all]
            [moe.preprocess :refer :all]
            [moe.samplers :refer :all]
            [moe.moe :refer :all]
            ))
(use 'nstools.ns)
(require 'mikera.image.core)
(require 'mikera.image.colours)
(require 'byte-streams)
(ns+ template
  (:like anglican-user.worksheet))
;; @@

;; @@
(defn uniform2pixel [r]
  (if (< r -1)
    0
    (if (>= r 1)
      255
      (int (* (inc r) 128)))
    )
  )
;; @@

;; @@
;Made to avoid the hassle of dealing with defm, and simplify calculation
(defn moe-feed-best-single-n [model vect]
  "Performs moe-feed, where gating model leads to cluster with highest probability"
  (let [num_cluster (:num_cluster model)
        pi (:pi model)
        mu_vec (:mu_vec model)
        factor_vec (:factor_vec model)
        kernel_vec (:kernel_vec model)
        prob_cluster (map (fn [index]
                            (eval-gmm pi mu_vec factor_vec index vect)) (range 0 num_cluster))
        index (max-index prob_cluster)]
    (kernel-compute (nth kernel_vec index) vect)
    )
  )


  
(defn moe-feed-prob-single-n [model vect]
  "Performs moe-feed, where gating model leads to cluster probabilistically. It does not need to be sample argument."
  (let [num_cluster (:num_cluster model)
        pi (:pi model)
        mu_vec (:mu_vec model)
        factor_vec (:factor_vec model)
        kernel_vec (:kernel_vec model)
        prob_cluster (normalize 
                        (map (fn [index] (exp
                            (eval-gmm pi mu_vec factor_vec index vect))) (range 0 num_cluster)))
                          
        index (sample* (discrete prob_cluster))]
    (kernel-compute (nth kernel_vec index) vect)
  )
 )


(defn moe-feed-weight-single-n [model vect]
  "Performs moe-feed, where gating model performs weighted sum over all children."
  (let [num_cluster (:num_cluster model)
        pi (:pi model)
        mu_vec (:mu_vec model)
        factor_vec (:factor_vec model)
        shape (shape (first factor_vec))
        kernel_vec (:kernel_vec model)
        prob_cluster (normalize 
                        (map (fn [index] (exp
                            (eval-gmm pi mu_vec factor_vec index vect))) (range 0 num_cluster)))
        kernel-collection (map (fn [x] (kernel-compute x vect)) kernel_vec)]
    (reduce add 0 (map mul kernel-collection prob_cluster))
  )
 )


;For the hierarchical case probably the same but with recusion at certain steps.

(defn moe-feed-best-hierarchical-n [model vect]
  (let [num_cluster (:num_cluster model)
        pi (:pi model)
        mu_vec (:mu_vec model)
        factor_vec (:factor_vec model)
        ischild_vec (:ischild_vec model)
        child_vec (:child_vec model)
        probs (map (fn [index]
                            (eval-gmm pi mu_vec factor_vec index vect)) (range 0 num_cluster))
        index (max-index probs)]
    (if (= (nth ischild_vec index) 1)
      (moe-feed-best-hierarchical-n (nth child_vec index) vect)
      (kernel-compute (nth child_vec index) vect)
      )
    )
  )


(defn moe-feed-prob-hierarchical-n [model vect]
  "Performs moe-feed, where gating model leads to cluster probabilistically. It does not need to be sample argument."
  (let [num_cluster (:num_cluster model)
        pi (:pi model)
        mu_vec (:mu_vec model)
        factor_vec (:factor_vec model)
        ischild_vec (:ischild_vec model)
        child_vec (:child_vec model)
        prob_cluster  (normalize (map (fn [index] (exp
                            (eval-gmm pi mu_vec factor_vec index vect))) (range 0 num_cluster)))
        index (sample* (discrete prob_cluster))]
    (if (= (nth ischild_vec index) 1)
      (moe-feed-prob-hierarchical-n (nth child_vec index) vect)
      (kernel-compute (nth child_vec index) vect)
      )
  )
 )


(defn moe-feed-weight-hierarchical-n [model vect]
  "Performs moe-feed, where gating model performs weighted sum over all children."
  (let [num_cluster (:num_cluster model)
        pi (:pi model)
        mu_vec (:mu_vec model)
        factor_vec (:factor_vec model)
        shape (shape (first factor_vec))
        ischild_vec (:ischild_vec model)
        child_vec (:child_vec model)
        prob_cluster (normalize 
                        (map (fn [index] (exp
                            (eval-gmm pi mu_vec factor_vec index vect))) (range 0 num_cluster)))
        kernel-collection (map 
                            (fn [x] 
                              (if (= (nth ischild_vec x) 1) 
                                (moe-feed-weight-hierarchical-n (nth child_vec x) vect) 
                                (kernel-compute (nth child_vec x) vect))) (range (count ischild_vec)))]
    (reduce add 0 (map mul kernel-collection prob_cluster))
  )
 )
 
;; @@

;; @@
(defn restore [image model box-size hyperparams]
  (let [ret (mikera.image.core/new-image 32 32)
        feeder (case (:feeder hyperparams)
                   "best" (if (:is-single hyperparams) moe-feed-best-single-n moe-feed-best-hierarchical-n)
                   "prob" (if (:is-single hyperparams) moe-feed-prob-single-n moe-feed-prob-hierarchical-n)
                   "weight" (if (:is-single hyperparams) moe-feed-weight-single-n moe-feed-weight-hierarchical-n)
                 	(println "Wrong feed")
                   )]
    (loop [x 0 y 0]
      (if (= y 32)
        ret
        (if (= x 32)
          (recur 0 (inc y))
          (do
            (if (or (< x box-size) (< y box-size) (> x (- 31 box-size)) (> y (- 31 box-size)) (not= 0 (reduce + 0 (mikera.image.colours/components-rgb (mikera.image.core/get-pixel image x y)))))
              (mikera.image.core/set-pixel ret x y (mikera.image.core/get-pixel image x y))
              (let [box (nbox image x y box-size)
                    box-vector (im2vec box (+ 1 (* 2 box-size)))
                    gray-vector (map pixel2gray box-vector)
                    uniform-vector (map rgb2uniform gray-vector)
                    res (feeder model uniform-vector)]
                (mikera.image.core/set-pixel ret x y 
                                             (mikera.image.colours/rgb-from-components 
                                               (uniform2pixel res) 
                                               (uniform2pixel res) 
                                               (uniform2pixel res)))
                )
              )
            (recur (inc x) y)
            )
          )
        )
      )
    )
  )
;; @@

;; @@
(defn log10 [t]
  (/ (log t) (log 10))
  )

(defn peak-signal-to-noise-ratio [original noised]
  (loop [x 0 y 0 mse 0.0]
    (if (= y 32)
      (* 10 (log10 (/ (* 255 255) mse)))
      (if (= x 32)
        (recur 0 (inc y) mse)
        (let [original-pixel (pixel2gray (mikera.image.core/get-pixel original x y))
              noised-pixel (pixel2gray (mikera.image.core/get-pixel noised x y))
              diff (- original-pixel noised-pixel)
              diff2 (* diff diff)]
          (recur (inc x) y (+ mse (/ diff2 1024))))
        )
      )
    )
  )
;; @@

;; @@
(def result-model {:num_cluster 4, :pi [0.25823461887056665 0.3908735182299374 0.18775193737133802 0.16313992552815806], :mu_vec [[-0.26914844247183467 1.6751372082493092 0.7973377351806246 1.7233505242139717 5.027733579997319 1.8718793962643 3.666652462106902 2.368969560221711 3.032829020752547 -0.47889347233219404 -0.03353497554426088 2.7826508764206093 0.9554132103757187 2.3292470716943097 3.4473926352080433 3.8792952127831857 5.117287566414453 1.098795424655592 1.1390113972603075 0.5711006831394723 3.328975979835466 4.9901873083263375 0.903688877512153 2.6729549513526383 2.4201297575626] [2.2503348963208922 2.067899544261871 1.6425855039873087 2.249258854074466 0.9924294799591018 3.140857295076236 2.975954993303961 1.4765249361765345 1.104665049670745 1.480673002340573 0.6929181547081593 1.3757437733790998 1.5254643285814065 3.184768684831144 2.8888125719710436 0.9252497368473775 4.293350979591502 0.36794331226752286 2.2711910482865427 0.018847474534185338 2.464799603409393 1.7451759092055188 3.5227585955544414 -1.0022114218793892 2.8085847785217215] [2.6695409851848586 1.8377500861542455 3.2896352871460173 5.8835212636203496 5.376776128523735 2.531303726349583 1.2743234521451094 2.9044572737337258 -0.18152995761385293 3.443158337166853 0.12488839470700697 1.295172936769355 1.399438777738597 -0.6864946739643942 1.8455785090736732 2.0261909539862524 -0.5621505377374265 0.3755295593479824 3.741324121926968 -1.7331070219063367 -0.5654364222154835 0.3045186855189823 0.8485146869490847 0.42547526193831686 3.5891671509723095] [0.15779179427384982 1.6241468226903497 0.82579309633636 0.6031076262523882 4.440767634451335 3.537632747784426 3.807522768908524 -0.492412038475881 -0.4512672374016269 0.023283053654153285 3.710566053901344 1.9058517865555598 -0.45237743676076114 0.08737382314614894 0.4075295045297136 4.086582066846502 3.463622791565113 -0.56740335862724 2.524678426967027 2.111250157322269 1.4418185805408623 2.9249061227603566 1.2445139600470134 2.477797752119329 4.17151061748471]], :factor_vec [[[-2.4472217802449765 2.317088974662003 -0.6416669860396325 2.902063927470289 2.90056764264415 6.3863603935666795 1.6272862675350186 0.4985365791701132 1.278238484809428 2.941254685403515 1.1306110069938369 3.125308794932042 0.20254237311963752 0.3714257868403634 1.5173313957029764 4.312398467496065 -0.7445290450240067 -1.2492452226234572 0.5285934977625437 5.131938234681443 4.023566720843551 1.4098436769562166 3.201642879269135 -0.6721138404581359 3.3995411478205377] [-0.8280330727545717 0.2481647035524005 -0.65071745473851 2.062225105782688 -2.0959005220315463 1.8494912192957749 0.9721029137404822 -2.793586121801269 1.500161357006852 -1.1229292534809932 0.7971921461648863 1.6993964591881399 1.170628908810619 2.5838153825471775 3.9990085747990634 -1.1034320900150543 0.7667265179342309 -1.2181693037734642 0.4080027374342413 0.135092604087378 -0.4000823556612838 0.38569680085406666 1.3311863888633384 1.5101464606301696 2.5030405569224605] [-2.0983507077117913 2.2799058365724383 1.470594968009257 1.7306964727095295 -3.3933349374890778 -0.05460394656465395 0.4901359549356218 1.6572690532744156 0.020757924817225937 0.7804447377324244 -2.1965323723758967 0.28469070317691647 -0.16392900178650205 3.005520988872945 2.188118846217754 1.377666908589584 3.531741801023762 0.5448253321068373 1.9992849252269935 -0.3757173687700479 2.60821833254381 2.013914250371957 -1.1574473261488794 1.3662370813086033 -3.2910866289132796] [5.250655758374225 0.04791090235306372 -1.2720360483241313 0.37615445301409167 5.593102671972864 1.0066398589195136 1.1046945128408105 4.538712312696325 2.3853481842277544 1.1664448804865841 2.376351176261373 0.7892505018895171 1.121765416815988 -1.433821074099996 4.18042861214949 1.2321303120535025 0.7992497448127647 -0.6203898605092146 3.201085566279448 1.3675395278109788 4.429881211433453 2.9807464364572818 0.364817383041219 0.27665653998456097 -0.9962362548369044] [1.66102571790511 1.5778894685203015 -2.281642625245683 3.1213928665213264 2.080328671198305 4.498964111450405 1.1391109817280434 2.422292166230606 1.3082497227390995 2.4445642457170687 -1.98340531726538 -2.592297911774755 0.2734775160084071 0.5858605129840269 3.2284453647869475 -0.08018496841606892 -0.7363035854906508 -0.07145051262290547 3.4660048143248323 -1.097670689135446 2.542149880007944 1.0788439415227158 -1.6775940975178112 -3.7435424875291705 0.6072314218384746] [-3.0162850286664487 4.015684905287896 1.6649922034320404 1.0175236765663107 0.16226109831293767 -2.584909337609566 0.8897121122675865 1.9650353124387197 -2.689412791648379 -0.027484688642199995 1.2638012123668267 -0.5955681589374084 -0.1620253121718227 4.309255142465911 -2.0125898853805437 -1.2720087485186458 0.48190300922714946 -0.8126911986385088 0.6899953790181452 2.5053932747670995 -0.26217097036056725 0.4229463853046074 -0.90717713827385 -1.3132340334262032 3.24412369547714] [0.8076799842755454 -0.8432585500059606 1.6110007719851676 1.7300594595320642 -0.2552232370546139 2.8695307564978068 4.810235237339576 -1.0763563520688 -1.1403507243667077 -0.029258148062466738 2.5538526055289887 4.008085185776616 -0.0028911235029336346 4.092242289764105 -1.11330978371429 1.211874134537907 2.638382708413868 -4.136434400722797 2.32410739772115 0.6881757163785864 -1.037028087341846 -1.9609298664434514 0.8732963585368063 2.993299486120254 0.07978225018792828] [4.427525114185048 1.3384451790029388 0.023064785300728752 0.8184868528705835 1.8662609025468129 2.3406039433390315 1.9702076603393366 0.7212557326407047 2.4257498804857462 -1.779898580570341 -2.1531700601570645 2.3073414591883776 3.6617162725898003 -0.5910933584847937 2.950986228831935 -1.5443161692651084 -0.21631970725429372 0.7638463810450288 -0.5029485656848256 3.2904458152191562 0.3582908611596579 -0.832421490440794 2.776018464286147 -3.484688824937157 -0.2314362584372327] [-1.053412320239501 1.2613309143225933 0.9307228995777389 1.149520517580681 2.0579373916090087 -1.961601611642335 -0.25789739533589606 2.770491162325354 3.4280933616473286 1.6606209211476415 2.3315553485194256 2.5450567948264293 2.30644348248884 1.1887972858498312 0.5527474969151568 2.5600338990823905 -2.9888657882246523 1.680533307945721 3.8017440519483188 -1.9571217181810034 7.025445969996125 1.0549385559559612 0.37665925690618507 2.3200398406492284 1.6486046095964149] [-3.0845672650586016 0.33332282839550054 4.26943461616055 3.7313563542782893 -0.281060861106049 1.171895708236073 1.40415941236678 -0.09545618884620866 6.3395193575568145 0.15773413966726813 4.8334066834327905 2.908515883704948 1.6568891456822596 4.587134094118638 2.899164568860111 2.0023351602197557 0.4138876274175489 3.096849222411967 3.052370641562144 0.5371780631800671 1.8509291194400896 1.816395602870656 2.3243818999843806 0.8478709218682703 -0.2705519160981087] [3.09727902293185 3.930906409376241 0.39182020785994387 -1.3441371806866118 -3.2947878721709376 1.7081398289633927 4.887040745773088 0.1429359688848615 5.3574004292255 -0.7258074022565124 2.0211408346041324 -0.5363599879082515 5.249741919315212 2.491658147927322 2.5992916725563733 0.29981830716234303 3.2761407567313743 2.425522503848666 -2.1399059465422727 2.377078740437349 -0.5994760410230768 -1.1304332275979148 0.9517115332583392 2.460775697554384 4.204120348977029] [1.0562226810660498 2.3889749815057932 1.794166855527596 3.878083320924234 -1.935625368220975 -1.7636022605114854 2.0271647320732176 0.7866935846027785 1.5007878150429743 3.1740873517362584 3.293999850823211 2.233596158616134 -0.5239044955660959 0.7070093501285191 2.768439537410064 0.5135228891413328 0.08700815792728622 -1.231638082755787 -0.32326989063430855 2.0034850073027304 1.99563444859868 2.092797730528262 2.661731840086926 0.22815032276120706 0.8081851492066026] [1.9748401000934503 2.849535981550824 3.188651455071876 1.5310398089143815 2.010163157296857 2.8364738232228834 -1.4127196765804064 -1.0169254398080945 -1.8892195275961572 -0.6077088499584145 -0.5558550376502482 3.0903563742453897 1.1152521881402195 5.247482629343074 -1.6552799006833667 3.6354439730947674 2.4400706511749317 4.999833722963437 3.7778591453577786 4.279869093637699 0.5945798021627554 3.1119261738997137 0.9571280979660486 2.7525746140935867 4.412583346850357] [1.5568413297903807 -0.5750289878972399 0.45001514188947145 1.0005523900112618 0.21270050843835497 -2.887500989458073 3.34198766465034 2.4844558375942953 3.131787169125015 -0.7810213921669782 1.6763461268943425 4.504248974039161 1.3991047252212776 -0.9235626376991364 0.6487535840193668 2.479567874113199 1.9426126365027616 -1.6703698405280325 -0.00860587207247221 0.9666539753665135 -1.2908218695488287 0.11767078628518335 1.4937381786875203 0.5498069313170535 4.379708421420155] [-0.8765185183770927 1.17644550523687 -0.7275627855210356 0.7143491196060423 4.0910496130618395 -1.0093590640016434 4.491170534162929 0.18300874749267282 -2.5108834434406493 2.697752084101394 3.887595170297493 2.3070641857548084 -1.052212696727465 0.7251729391788251 -1.4490831887377538 -0.03170726428225379 2.0545141614096596 3.5151959767717433 0.2903062564699612 0.8509021057026571 1.9606376702372494 2.223177771286565 -0.8940203161323828 3.320912054159495 -2.956839188540231] [-3.3109465379985306 2.2348488384922542 1.1482884050612296 1.7187606534891637 1.873539338752087 -1.6084499166713475 -0.23251147262477811 4.298475117557688 -0.4932867425385141 4.17028572639693 -0.8098261647603684 1.9159940672354643 1.158051712051832 0.4728070516617361 1.3588758311065696 2.678619086205191 1.1013309816590398 4.282348870155747 -0.035009848018147105 0.739187816168509 5.622000292636291 2.2637322988800426 1.4722060972839222 2.1405228632074094 0.577860299578106] [-1.405015743050439 2.1762886669636696 0.8029723792912672 -0.5968949139393249 0.30016669386433037 -0.1929302742891379 3.0403975670306256 -1.2457005700350625 -2.626254461939235 0.7938739011525573 -1.6507135343517296 1.0945357020541135 4.543454643198112 0.35624634621826234 2.322958645019512 0.3094468844629249 0.9804133024753395 4.177894796820336 1.4934682601057905 -0.10786106616458402 3.197255145637923 1.6511260293512744 1.2219002999153208 -0.6652611102689263 -1.3076885749844216] [2.8631063674866004 0.15072666794249945 3.0868015491307492 -1.5110239553206024 1.4631386404644933 2.1621095726276875 -2.354368980858723 2.5576990300977815 0.3223146449492188 2.4693029212112987 -0.4438424449063194 1.6044819400229138 3.2420357759147613 2.4469219797900084 1.1574198360235415 2.5902497912365305 2.562531044974209 2.1168556401158467 -2.545563499615516 -0.9790425623588837 1.8401312269163683 -0.9056282666054583 1.9440996627597862 3.1298270471363336 1.4541738271258362] [1.4148977556149267 0.0023715000928336005 5.405297009532484 -1.1956307212382664 -0.4981445842100838 1.986367685312717 2.028579790264268 -0.3877846109179055 3.4685800404667724 -0.822830357902393 -0.9556746429063494 4.0463009646919685 3.6612204433898 1.9226290780031463 -0.3724613045467293 -2.0915919950418926 2.595044486772559 0.3716184049120961 2.2521484769728284 0.15877198271712878 5.083265846508747 -0.3934218166123047 -0.4966173604965012 -1.5548313240071465 1.1000173949080005] [2.58843088099713 -1.9663695896396693 -3.119493023361856 0.3545529458461546 -0.45608540811321263 1.5708756279772378 2.5091446738478287 0.7616472151310024 0.41289026319861466 0.03810404262988931 1.181076637369533 -1.8802407148192084 2.775729125058218 2.7688366422381563 -3.15117901797192 -0.9501425784065167 -1.9901885415997986 -0.13564483565568208 -1.49988631162929 3.3221786715894344 -0.3807475067634736 1.0187460940083304 0.7032871114415857 2.3660187953379666 1.3379897163209262] [0.9099689269088285 0.6380628957588504 1.0719984369284732 -2.7106597520402413 -1.429266804128389 3.2445321142145387 5.193304043763369 0.8966485226310534 -0.727437899857182 -2.0838230067809227 6.228924688744391 -0.9502484736094525 3.7889638928127836 1.1333163466310763 2.1344356696158577 2.0651784818794594 0.6706322615187819 0.9908751516244826 3.254814805318352 1.4717933940104808 2.1128861186546053 2.3936447296176366 -2.213986590583705 -2.802960278450675 -0.23371253484001242] [0.5890346209001065 1.0604303005329794 3.1969906896785965 2.5715892925778663 2.1705334829806637 0.6024848548492305 0.5159643588998407 -0.49870790676505616 0.777682263844224 2.2670301287825922 5.9387125802102565 1.9830952671245847 3.173882143994654 -4.450044745584732 0.7202497623230384 3.2970087318853056 2.321487754416749 -0.2576056987338715 1.0634624617690225 0.5636196433216542 0.457535649943582 -0.6541384258087617 0.7552120538490124 0.2703013234432702 2.542078634410684] [3.0674298192722484 3.8262578173084094 4.0587166305530396 2.331514655106384 3.398696642286471 1.89573845711898 1.410701558988564 1.0572347649797376 0.3920865624385339 3.6240391141686175 4.977299531317794 0.8969309799657749 -0.5449680811801176 -1.289704188415568 -1.1231026167799913 -1.6618810218089886 0.3417651044975947 2.170851392378078 2.2006731666636488 0.35010590998900315 -1.5413931990321816 1.371008297887297 5.431859500022517 1.9658930276315878 1.4106187514464148] [4.860911110669255 4.155744083145862 3.9978848149054262 4.2703443384436 -1.5959985181707563 1.222638433011775 1.063498411873783 2.0528774209943066 2.125293306830554 0.5167116982179365 -0.7870224037882787 2.6365017476108834 2.3211306797591775 -0.7006516420883981 0.13986611313416752 2.9527679991267832 3.953291324772339 -0.6407602488663413 4.3737064938874735 -2.034771661875794 4.317835921970131 -2.095607284679644 1.754193720712974 2.27100127330348 -1.3252734522470644] [-2.124505720432019 2.0686406803156245 0.358237164847899 4.748091749881761 0.1929563153034205 0.4181375072446992 -0.02096626793152767 -4.411850043638066 -1.2922864732745238 3.453033305914169 1.7803602692312381 0.1325163184997018 2.3067330710486593 3.7792623265728102 2.427549085738548 0.15561981887437604 -2.730068424677151 0.3504384549325317 -1.9864681615718034 1.3131994284314827 -2.1105152429229306 6.131787767524095 -0.14864007915052002 1.7076946022073893 -0.1643604740832545]] [[-1.4701176029577927 1.148832770198286 -0.07493232686389728 2.497541343584989 -0.18299625739442327 -0.7912972936909457 -2.545030330302854 2.5016937261686767 0.71899916762523 -2.3556924651559754 1.5084329559061325 1.5052443332283687 4.685371848985546 -1.5236370220967772 2.1484427218028643 -4.809555933937458 1.519821054347433 1.427895631913013 1.7668223205295335 -1.152283232854593 1.6350787600864187 2.751400612858646 0.4277226196013635 -0.6456317971178551 1.7581460589906648] [-2.1226732122673027 0.29871119232556875 -0.4558156818525083 2.7202975861479857 2.095482681949916 4.948921189899725 -1.5759466211340523 -1.3780413158436757 1.311129213138022 1.094623379313041 0.41352588940570456 -0.25487606557868125 1.4126999524770558 -2.3103848755468372 0.9809765676027533 -0.40451560322386304 2.2425741542246045 2.0985973983196544 -0.18064689696250769 -0.6353005012702868 1.2886772829317676 -3.1951387327707748 -2.161357879208549 1.1252480496722623 4.29237054210679] [-1.6538842575211143 2.711967037948088 1.3432082414720634 -0.13088659160054572 1.7491654251048319 0.9971821985009715 2.432151247930353 0.6868413732694609 3.881973839177662 5.529618489475274 1.9837360143467775 3.9215607667359222 1.8258615671191398 -0.6924012386279073 -1.337915433639568 -3.234339069737321 1.4638617533081024 3.6308037689006687 0.1190217878690123 0.08381109355892569 1.0420529729559354 -0.4841514652461256 -2.2015066914833117 -0.5128632149661463 0.5516557368136672] [-1.7821810237807951 1.9257707734849703 0.8564576074202187 -1.185818810664871 1.3696394435718195 0.03963991651755372 2.275625554392668 -3.4062077433863944 5.93774132554551 -0.017627773397323798 2.0782381017196245 2.6916626840979165 -0.6122044900151884 1.3069091822220873 2.188543505157216 1.6667719941473214 -2.5717304108406345 -0.704977609233076 1.4188834472063216 -0.4806458636993909 1.5979792809816398 0.3425431914340086 5.573047965254456 -1.97344519067149 2.03057307263278] [-2.1502526823735093 2.4137618541927717 -1.105581128313243 -2.8582046171706366 -2.9188614182373223 -2.521143338625873 1.734865284601034 0.04885754429249578 1.7153331969822068 -0.42645583905996 -0.6802231598108919 -1.5888384451763393 2.936417231414562 2.8122010700659517 -0.2892827416857582 -1.9228640424300427 3.3577822176377756 3.4006332204087375 2.8281999898241867 3.7830199198056715 1.5504546889284017 3.182209299189457 3.1076598385508185 -1.2972027191496367 0.8799882785097466] [4.685287733429182 1.703561427443676 0.22297608006732006 -4.2523971876598035 -1.11994648221064 -0.3939198019741563 4.072937073486887 -0.5403355941816295 0.28715657724217547 0.12872033849300457 1.1304276614222748 2.073092909482198 2.999027776846221 3.2668133045143986 2.2506239416573903 0.9182473323343858 2.415831429630658 -3.2858902929602163 0.318405035706429 2.1693706055852897 -3.6185067795487544 0.6959918191108465 1.6146957180027237 -0.7434753881777465 4.317092748428343] [2.1610030741514556 0.05613974920542464 2.2466178657261073 -0.2577560134405954 -1.0135748641865763 -1.2426227155361405 2.54343993958523 0.9653683257401656 2.7290281699749417 -0.20442134057498218 -1.9565348028821266 0.04684109859016827 0.39213757438457586 -3.8175508933252127 0.8273059588078275 5.370552280076456 -1.2824580382068786 -1.2979629249315852 0.19692403556435845 3.081003583213112 -3.9142034106742374 2.06365521466003 0.020650569110666428 2.0648126950629293 2.4716432122780265] [3.2454523373717485 -3.6524053640718632 -0.5809232880092052 -0.09080753793676122 -2.5282969803340767 0.46767026495967645 4.049266568631678 -2.2971516605453344 3.4312871580661657 1.1335378873109796 1.8201356231179948 1.0791244198807353 -0.2260506283010133 1.3165003703397327 -0.8451862246709001 1.1253129975855727 0.6007106812226439 -2.341451898458767 3.918145432894362 0.6374674115983732 -0.5527165207021161 2.2817075280305144 2.281626339005987 -1.3250321062372592 0.5323497174217459] [-0.21266170316017785 0.5630906848969846 -1.770578895048819 2.2920576458742703 -0.3691820929058909 2.475912052708044 -2.258052614926377 2.0419420651296827 2.718630481425058 -2.5624428141337114 0.016317005762690573 -4.5780809118529815 1.7595491182636396 -0.922607682514518 -2.114776242385874 -0.9361350783519635 -1.8799467868636919 -1.231225582655878 -1.5556010333390708 -2.0712992347384005 1.5647025505352585 4.876412804804755 2.880302517853547 -1.7786770393277336 -3.608657018361865] [0.06833813323951965 0.43565477076420367 -0.7468944629235312 2.7421349674628446 -0.8452268707844892 2.8031906183882436 -0.57059400967879 2.3649777968344767 3.5159306161001935 0.6671351598405524 -0.5336126938189287 -0.2364230943885346 0.18536230709147827 1.7587775894740532 5.998711649165396 2.607678957275718 1.0222409668430976 0.27679307574065304 4.728019235225434 2.795150678623492 -0.6697585673832946 -1.960603433380637 2.8540938534889513 0.8081263205564881 0.8082126921898454] [-0.8842457282192506 -1.6863650090957307 -0.23094328362229044 0.2900351092872888 1.033886465949403 1.7086155761389743 1.53918845928172 1.8529901218996594 2.5165984583789376 -0.46531502394330393 -0.7526466417037214 1.3852695651725664 5.444242618732172 0.5559815208239359 -0.6580211484399552 4.23190241736581 -0.7095809638987125 3.4563061786687412 1.440160594274278 1.3102462699006172 2.479670291384573 2.527641686119331 0.8913316734478527 -0.3888654592196632 0.2078617841685343] [-0.2798813060577112 0.06670687443941992 2.9679753392398487 0.10328560384654872 1.3705668545221255 -1.766213559560851 2.9951743136902453 1.685495658905138 0.40413678446866697 -0.5493561193638226 2.5323244081217826 1.4615557349598736 0.36164957988987834 2.839557342485201 2.5716200692394002 -1.337934582704984 2.194863956096966 2.162639892343143 -0.8751798096938264 1.6721510069181593 1.7683289294031534 4.001058615913438 3.6564130879783945 2.5421514888690133 0.1430741005491164] [3.5968625630793523 1.0544386699031385 3.161382969446543 0.5246526760799906 2.395674594897566 2.892408922886635 5.750666130137308 -0.07099709800879461 2.4378606730675196 0.07059957071614043 -0.7420350778720657 2.572718964819666 -1.6668281736389932 0.2657112133502536 0.6730617406572704 -1.1537030958519585 2.655994658746756 1.7593611622000067 1.8157953745419713 2.166442068787897 1.8288917598252956 0.9144816819852933 -2.761684684124311 -3.174525924023315 -2.0315737732541814] [5.0301234912619375 -0.6863150646574343 4.230787690440485 -0.20902433857328662 0.48166967062566357 3.348702338341211 -0.6736389222147556 0.1282830630156594 0.06106068592165881 2.122708839320285 1.2395164598571613 1.8229588425026 1.53519929662236 0.4148883034033809 0.7628578984182335 1.3565926373781725 -1.8798381061105012 0.3687000354837392 3.3097964456301963 3.1241547453014284 -1.9306393652603764 -0.37295914837599087 1.3754035602350165 2.0743170575364926 -1.0514021420507458] [2.6652119515722834 -2.744547789837257 2.2042974338162438 1.1903341562474754 0.239710116022544 -0.5435483047046246 -0.06392685689023159 0.2703051453405313 0.6363672156800104 1.4603099732631917 -0.9380763590392576 -1.6076255699062223 1.2881896384179288 3.307774511899394 1.2274366104742829 2.1178550992485157 2.4278603428461594 1.1734296207759978 2.47576546851601 1.0152177722013291 1.510082935307616 -1.407410935329469 2.543024533003556 -1.1261172178318142 0.2351566653783862] [-0.030632624027962185 -2.718924564562411 5.0568142231807744 -0.6930026156993561 3.72374661399942 2.6450484970219024 2.435826893326561 3.4175539663882155 0.9271268971564475 -1.7353485451289195 0.05311875453078618 -3.6204117675359946 2.581134066275472 2.59008360003764 2.14157898612439 1.0139181925963994 1.2499139137937472 0.4877718592532483 1.1141944267363406 1.5159818771872149 -0.08090496785323387 0.7287101113710799 -0.6301734432999793 1.0781013003809998 1.1431086618231991] [-0.5980382490360148 4.371529289344581 -0.7570863193378037 0.7216404395550533 -0.19877343709820772 2.6569427030916106 2.0995087187394708 1.297096308627216 -0.3170332216081122 1.0047184199304873 0.14145204622771224 1.0306499027312688 1.8175419076448525 2.837503637090652 0.9956576175740831 -2.811073106117816 0.17086307507342113 2.17781114152315 3.453380375203569 2.00483824082427 3.3834677962366797 -0.3759254470562694 2.9372502964903435 0.05146996207517773 1.74822261554592] [2.0740633685983862 1.3117748581468582 -0.1367923379639202 6.833205794008233 3.5702129437412706 1.2771114647135424 4.015935748413426 2.2305946647481107 1.6876477629724091 1.9622944882432716 1.6766666435273994 3.307872518584875 -1.32871656123142 0.8410115022916786 2.2714528722118454 0.18704105359184164 -1.9064476771872059 2.7021675136294085 2.914508800494087 -3.435684400798375 -0.4813472540081767 0.3123728482352267 1.6682915353608476 -1.8523505882877238 4.163559489182228] [5.050444818255779 0.008411961229693454 1.1774192224160493 1.8577747014566006 -0.7823285985479076 -1.628667625276523 1.4571309340452863 1.480098482761918 1.3423378602639215 4.784012692448096 0.6189096051652011 2.641859604628487 0.2183821403047883 4.1189366876936795 -0.41997494863355733 -2.704527719971335 1.0880095536406746 -0.15092386804239988 0.637711767061304 -2.0880576937972357 -0.7910965171475395 0.7855521258680828 1.9179073145833305 -0.571855150749377 2.304782051879948] [0.19013410258859265 -1.112175155471249 2.62929605178656 -1.1955755579745047 -1.0466575179492903 1.9655416374595556 -1.5097804522299914 4.050145696149187 3.795535014044224 -0.17099749545582288 4.051855599955877 3.7021938132616143 -1.1087745150358863 0.8149782518686342 2.0076796230398126 0.29284719135382486 -0.25965422659212845 0.3395535594115585 1.227179123795449 3.0774618208512616 1.647089490813257 1.8218164622693065 1.023750977439459 2.6337732770524687 0.8457936276086189] [-0.9482509092800304 0.372064144939248 0.9306351801301811 -0.049045370464274596 3.0905321300568316 1.145873049493368 -0.5601846027084694 0.7911260974382812 0.9995036949284624 3.350004743712781 -2.468432347715555 2.9399003093326455 -0.8098512517206313 2.8116747494941405 0.7778098785331352 -0.3528766439746809 0.22583836823768033 3.8074839296618284 3.5072492340315846 3.708941398142908 1.3441163024336193 -2.936554653688773 3.2026970695458665 2.4018951215171978 -1.4488834933883132] [-2.2204190857020976 -2.035899681327768 1.5075893897290653 0.21751405566490833 3.7236406267485047 4.868540967416058 0.9837394790649635 -0.25039779864570844 2.9044231867148906 0.08563373680296682 1.7997576651802007 2.7673884595283873 1.928516695922829 -0.6776942271047297 0.008963436510927902 1.1320862566824514 0.8018758830070751 -0.057098415939345504 1.7648397878005633 3.1426375617163957 2.6293261863241404 1.0855311916123576 -0.03467541244396988 0.5116674426196457 2.6632904800312756] [-0.8320631554527931 1.7425677113445044 -2.05635178124219 3.1704135844818646 3.5826889252868557 0.14817716853461893 0.41642475121429023 0.36138687116147095 -0.03408113745012886 -1.1710924702206071 2.9538807272516725 0.6615803704976948 -0.2725984600510112 5.283815001249567 1.5051195266662576 0.9502249304054164 3.951300957472764 -0.582340079525852 2.5282454141218116 2.0683029620337035 0.8532678260332587 1.1076259363860845 3.04762649714746 1.3008470092259292 5.1646298205503784] [3.5216788790330757 0.06524921425561114 0.5093453732305393 1.4496675235697807 0.039200841949561305 0.2569612464728005 1.079133937521908 2.010531067192174 1.5116134293727663 4.236833402641792 1.1796309463217622 -2.082481040919086 -0.5304707615286044 0.8367368237688397 -1.4588116885598263 3.6923578965299533 2.9503800460734135 3.2723512216375887 4.838647303856284 0.362808600382143 2.8732105648736637 1.4883817394875234 0.1812808622201798 -0.5067974728280502 0.6710650097636077] [3.4526331417285046 1.604380303302435 2.8954620855055073 2.8541346768583598 0.708454259988998 0.550854520909196 0.36029038192180196 -1.8020349965776568 2.609365041991055 -0.6216765197709087 1.627534633163486 4.050530465169783 2.413091517908322 0.0657477826749665 -2.9047738373987824 3.430514258144663 6.623657617751989 -1.9902759442459574 -1.2226521464963684 0.8670892689072582 1.8172680702398423 0.7072708043464264 -1.145557922230461 4.4768505030352035 0.49819211574017475]] [[-0.9300475984712566 3.1457614458959053 -1.0130877669187712 1.7419399514386869 0.5633030139514235 -2.126426291084221 1.7468192761412844 -1.266569287456842 0.5200017029879177 3.477308751536433 -1.9743551973428684 2.985666454147137 -0.3625430903335123 1.1120824906689624 1.9501126685959838 -2.9825020390224677 -1.1084322204603163 -1.3264803774042333 -0.375640778803622 1.9797443261944458 -0.28379543779617444 2.303463549630244 -0.2075373148219113 2.7629426225403417 4.4169555439156625] [4.000756015812441 1.7200495565683958 3.3070661482769443 -1.884207969804784 1.576437095080233 3.4110620907762277 2.476828206389878 0.12039960732690846 0.07703282409808465 -0.26095297379872573 0.573081216172663 -2.145883882435405 0.8744471003534132 -0.26145475960711395 1.9726131744342932 1.3497950181435576 1.5605980263944708 -0.0992846914879082 3.1168263310526783 2.175985043801079 -2.4069868401962333 0.0987007164061372 1.6513899877284257 0.5972664040538096 -0.88633262292318] [1.2197838099962022 1.4152190179369584 3.879118149153246 -2.1796333425344905 3.0683240393264395 1.3754956126955025 -4.774477878763443 -1.7223276231033315 3.8261988300583734 3.24587943629102 -0.38060109526750696 -1.5499607130900839 -1.6616401688986202 2.7410618620985616 2.3610445748927162 -1.0044671910076555 3.4228583804950192 1.5554145002009645 0.6388659239937925 4.027683692680711 -0.27347890525315144 -0.222866799979494 3.9488678037368827 0.5953286778387237 2.533681179817588] [2.1149805818881147 2.3541684408755765 1.692086691145391 -3.015745130242699 0.21579078815022112 0.8717627643341025 2.145954712196751 5.105264797872359 3.6817391547310003 3.1386252123298144 3.1011970704593206 2.271974932528675 2.4289876990232604 3.6781441267344177 -0.21837395222608835 -0.3257579757738229 2.1851414232893394 2.408430093926562 1.6538094817539832 -0.4009767264130015 0.7875783811472739 2.2699722531130724 1.2738501832085831 4.580059886309115 0.9026725589315312] [3.3913145669401086 4.463358669041119 2.135061204718736 1.1449651840252733 0.7571374074999999 -1.0895185944619534 3.0721580031004816 -2.305051815357269 2.62111600738982 1.9470683334506567 1.7772307801020328 1.5668491584051711 -2.5051303512693393 0.12614386886377948 1.7399279245493358 -0.7553372548836583 1.3851605887958114 2.875313613877586 1.176896744953444 0.16232370779959493 2.885131156780822 -2.2037993006854415 -1.4663430123243786 -0.011488764641795157 2.173729566353038] [-0.018530040093104994 0.7432086131902296 4.064972854891277 1.3202250504399597 6.08415012218094 1.4944577245537773 -1.6986003902620306 0.6252542049917609 0.7019171230403003 0.9446752206847919 1.9304230570169054 0.5198893315214201 0.8983053359672567 -3.2602558582871444 -0.2767340121656183 -0.40655813875325464 0.9155078718137657 -0.7574817465006614 1.7221330090378806 0.9766897926784635 -0.5033847148906867 2.3520058576462404 2.802799697888229 0.8476549081921003 1.6938148125183226] [-2.358593584048448 1.2370631421110796 2.5606486455821744 0.6765127990693827 0.4246153610495851 -0.6593728249555855 -0.9684385272384757 2.417365525699994 1.5774560604616257 4.438584798607144 1.340947220098399 -1.2683226727276842 -0.8286256736944029 1.3523507268236348 0.5058745215530773 -0.08100009302361544 -0.9806865674882546 5.190403096656856 -0.2808185343089806 -0.5205547056128359 1.5208139766113882 1.1247042772190052 1.7158098287571 1.558577446376232 1.3040370357274709] [-1.1257373496426037 3.1087945860053967 2.263171068023601 2.6521235923520745 -1.5893767416708169 2.7145155029837937 1.6972560056944448 -0.5679957442994024 -1.1934603588257198 4.440386539929531 0.3259494383032282 4.227252139301639 0.37849524155066816 5.585825980443984 -0.7715667471186143 0.9329465476349447 2.33004316137988 1.3844998963330948 0.14403996138942932 1.6849299028236717 1.2394959136987778 0.5927137101952286 1.0663716184945689 5.883115836705724 1.8100560715675722] [4.959132343827843 -2.8079857496378717 1.0631305447734636 0.8688757675794959 0.9063397718156947 3.3904655560528703 0.39457515096357576 2.3808774330666598 -0.7683699540640359 2.9380492184667304 -1.0254552000340555 1.1533232169136984 -2.792995743980739 0.38730151132466417 4.398564346001159 -1.108614537474224 7.7664686788824016 0.10113804309706309 -0.5577539145272163 0.17266897391791614 2.1277788852462036 1.4362169626403216 0.6083030620999581 1.4038137950260992 3.1389993501906326] [-2.231813793911641 0.08860984654675985 1.291727002573923 -1.6993821456212137 1.1011066995085488 -0.3553114805697126 4.030173690599983 2.6477736152955 -0.31353046117525496 4.647962167537254 -2.0080176050998566 1.8521729802805003 1.4901072252518157 -0.42577049891930696 -2.2801357004589855 2.001641029545498 2.3261607529178265 1.5383286085344214 1.6819557649390675 -2.024745935127876 -1.4839503328063697 6.537012518560998 1.7062943392630006 0.32729739074341957 2.910706408601387] [1.5850209025704576 3.641730998007003 1.032645773431787 3.6816697744127844 -0.28189659183163385 6.785792143714896 -1.8477817998965729 1.3987763102270512 1.6279901776420451 4.763183468180349 0.051855482771175576 0.32611653186946854 1.4523771838622233 1.0533579267516764 2.320523755487847 4.781539414563596 0.286670051371801 2.1650711071582345 0.7196345486086122 0.7667299846807216 0.683862819644657 1.1485703453226022 -0.9829227135530636 4.65520262947991 -4.619940655144174] [1.8048229975942949 4.222628222542243 3.0751332194268444 5.091985901675993 2.509213416919457 2.566158963581401 0.27188115347103115 -0.18871158584332348 -2.2988422756803835 0.3945590519209541 1.0142113142141898 1.947503250958336 -2.495678926866721 1.3208611814978224 0.32232308268998044 -0.48027642565617623 -3.010664216512943 0.8528721699193365 0.3460590877451021 4.923243642648028 0.0359651077879497 -2.8465844671311373 -1.93491635841348 -0.9336844035471021 0.8545075741909252] [0.5409394000986123 -0.7126346842302638 -1.797884083283038 0.5609066376535372 0.7532547908957609 1.4866043776079643 -1.0244163256679681 0.9387897876563371 -0.01829466500819188 1.715501347560337 4.6288645619787765 -4.059643768534147 1.3191898989921176 0.4467094533924153 1.3965722435502572 2.0605111607835545 2.188738338737081 0.5318481431952202 -2.145513509019883 -2.4535592381850635 -0.6340372786269626 2.4622770986848774 -0.612171235539799 1.5036656840018447 5.525391240910622] [-2.531639329511149 2.940797322830521 4.114450111698822 1.13178556693282 3.374540048551248 4.228731695741592 2.023584979562731 3.7216250047853623 3.071947555640389 -1.859815990099583 0.19751286383101174 2.1901045684616385 0.23346928092607067 2.1087689582711957 -1.254409511926104 0.9068566583370273 2.9705971710192163 5.668463229717651 1.439631896239545 -0.8872149983438544 0.5110222528186782 0.6109612078472818 -0.9760952759505572 2.518487538265406 1.93473137130447] [3.335310115805483 5.799469455843968 0.4863922194093987 1.7897571368797047 1.673036841841598 1.068281902645218 1.1862913043472745 -0.8831990634430056 3.5984420133651294 -0.27632456748440504 -0.28105595215387713 -2.08205624464674 0.21295940776762567 3.601424088222196 1.7712018704926127 4.904602916766777 1.5717620367612852 2.8680599244708533 -1.5634276394685043 2.9822820494097106 0.7022643499484429 2.415062879036327 3.0074889147812334 0.5788988535936055 0.10180084995381289] [0.7822894698211404 -0.33248761973067475 2.4693820263613553 2.6783220477129444 3.7142914414770924 3.867594250608736 3.1850591239583936 2.411915648368037 0.7119954667281511 1.393587760358896 2.083487965778118 -2.323392672573612 1.4982873932931684 4.299884813222578 0.1738655609752544 1.3589100406279186 4.067680050063955 -0.4581378742081408 1.7249621687550456 1.8049233080276958 0.6447651340836165 1.6337578869871343 -2.7409490851297593 1.8334794360367948 -0.7379883495004074] [0.41983586785110505 1.1142384322588994 2.64509279731376 3.986874097886492 1.211749328936328 1.822882713414749 0.45333578768454563 2.029468126694141 1.743695046240197 -1.4289482907546338 -1.7536428461866165 5.837773923698527 -1.5439135809894449 3.589452984166502 -0.9306145145288629 -2.86980886402808 2.2093141063351167 2.3628747523329423 -0.1969126698738597 2.28088193189288 2.5940592172526493 -0.5728147325192738 3.468943111374993 1.2326941698563276 0.9929786506620181] [-0.34124295155545736 0.3981952454604286 2.516567092006795 0.7797170872748923 0.9844034011575166 2.4771114746086154 -2.3314779936467813 0.4056669807634329 -0.23498715159386707 5.382336093317028 1.6058061090401483 -4.221599967618786 0.10972198921453169 -0.6294543503543528 2.237358658770935 -1.0441125164541716 -3.782537887126904 -0.1993653217731508 3.424537557574785 -2.813262385771014 -1.2679750756439798 0.8350752138400899 2.0274814863362436 2.473289830004295 1.0183696251592553] [0.2924595192089725 0.19872463513372107 -2.54797726250084 2.9107244986151506 1.9113524729404618 -0.3006867128855295 1.14063070773043 2.3383296260454536 2.149940258200566 1.5377440562998719 -1.5641642831020923 1.2001442373132094 1.6097200872455755 0.9543098492347781 -0.5479626480179343 0.12519751143021463 4.854303808481609 1.1277664984388402 -0.02388723293877737 0.09989703707832776 6.155619021495353 -0.10716670541876261 2.447892955753474 -2.640321638570993 1.1353331596077858] [1.443582958806901 0.3908359197289859 0.40952360901562446 -0.13853062308938657 2.726538846872517 1.058974740081998 4.2516821281193256 -0.6513993160157845 0.8816706106111232 -0.11958303872886344 5.130433574944239 3.401541028792742 3.4347838116456173 0.5260540483636864 2.5579319897416504 0.7475797950959097 0.026668935608851974 0.5980156205641142 -2.0506967891152477 1.88911275539327 2.0707191045716096 1.6057885267565353 1.9893155802770346 0.3906823759582593 2.0538130950661944] [0.6545791909511995 -1.107076571219169 -1.4646201312178104 -1.2632153688930514 -0.14088346925566442 2.8481609539310306 -1.5873114673686328 3.077471951753647 2.292657955727214 4.230682125709915 0.17294540873591513 -2.793157710616947 3.601223489745972 -1.9407852232127527 1.3045446786706192 2.437781576844818 0.9433219891009359 1.4338903285758036 1.3812238606705987 1.6078654914329507 -3.2570731720672663 4.576390789749627 2.529304246858368 -0.9800185565409751 1.8032161391691173] [1.9948470557728042 0.929016549199835 -2.379755249634548 2.1066152075398645 -1.298597494582041 -0.7559888029325714 1.0726928051861508 0.8809374236466616 1.240245185109609 -1.2693474923400747 -0.7159072891331344 -1.1188425863214482 3.768961783520324 1.1595881654060483 -0.8002471234646318 -0.2164623186268173 1.0345800416451905 2.962654221813893 -1.2585908799132883 3.443478367518883 0.8075675180435702 3.3174766090310843 2.233048608831865 -2.1735334909447355 -4.043595291330916] [1.9355217356666579 0.2353108923716869 -1.545603110590796 -0.75482673002167 0.24923661556971455 1.3554562153147427 2.0080666249861 0.8631426749169162 2.7119214472077844 1.6368915630127172 -0.14553815186603059 1.9123978952782439 -2.8213546021464224 -0.025776198671420003 0.5110784840309541 -1.041536373519866 -0.193301264952233 -2.3089428988826826 0.8087925118798533 4.921773389476629 -2.5334563737668248 3.956207946253722 2.14818444946515 -0.18541382351589464 4.078983603704216] [0.17602409667021357 -2.0584803970834673 6.117621497699747 1.3594653892095225 3.751907288776774 0.45524577474035255 -0.5248409591958103 5.77125622681405 -0.0070136670079787855 0.08538396148541005 1.4396917340152593 0.49642702261623795 4.486794755615199 1.0270934009790103 -1.5034333827453317 3.854502069523526 -2.683402447717812 0.8406619509499109 2.2961700331876935 1.0989576720502847 -1.2126308248383513 2.5697953239618365 -0.5392155938373748 -0.016924478548186794 2.9253060452421944] [1.791885246996729 3.9262508387537065 -0.922186596807324 -1.248307258750518 0.10838724388399623 -0.8434893885417118 2.1922577540003214 1.0402229096569 0.5653064125098878 3.0350186075488343 1.4081651874895804 1.3418038880728598 1.8437172658227292 0.6814371051067329 1.6077926839709098 1.654547576733411 0.5428791406803999 -2.458635102965124 1.1904329197237231 2.124182710029822 3.1936538759711186 0.05773746463016849 1.6895099052051183 5.473343960876681 0.9514683932317931]] [[3.3962792006341465 0.46237999351032055 0.15325258822387122 -1.6033144184960868 2.4283309554318215 2.487523756318843 1.708584108660113 4.381678647315026 2.059931133236498 -2.4177123186278338 -3.246600861570699 5.485535923693415 1.5102965983081043 -2.44008571295289 0.2936031153491444 -3.793015978493366 1.8964175676321395 -0.2240457554424211 3.0772788435238394 -0.7069952492082614 -0.14752572478616344 0.7192207540538208 4.1061369555170595 5.132531964517265 1.2278294925892668] [1.178651867166281 0.8354844946430081 0.2816762979887466 -0.7845986931091742 -1.6455188013113222 3.98368285615869 1.1053241851640125 0.41073965003402124 0.7624429204548029 -0.17578027421563736 0.4373846911970032 1.7967289758380176 -0.6093747601933195 1.9548996122429614 -0.7680140658006618 3.8680244582674392 2.2647503816998666 4.901090285396812 0.7410552523159266 0.06364356555329465 2.765506873461259 1.9244059441055723 2.1613587169710113 -1.4455200214832051 -1.8723949333360057] [0.18482643289224576 -3.088432778169542 1.2796301248047564 -0.9487378080638655 2.845656108176673 3.0595599670590503 -1.8286640883016303 -0.8391856855772066 0.6460553019289975 1.1202759988568918 1.2465779157465742 1.5253563381344866 1.9889604179422977 1.2883342949276553 2.0148386930161917 0.2998967377211006 0.6611888581492666 1.5335810915360164 2.5479776831024967 -2.4695218588842924 0.5546772972409675 0.9450425853740637 0.5207821773864523 -0.8332856399694915 0.5635448115090045] [2.2420047824082037 2.012616312771234 1.2761610820709774 2.4075102081997466 4.868429737660341 0.7451685738467172 -0.6108234372525698 0.7100599822941791 1.6367711676287058 0.21220190887172263 0.9017531746194445 2.5883073680387687 3.3307293859345184 0.14676095732732264 -1.0893114582727472 4.298058755552838 3.067065038835475 2.824052472627562 1.2148103185746588 4.31774663706987 1.297214807441493 -1.7432370897157283 -0.42699812298579154 -0.09552088447582086 -1.5411577359179232] [-1.1626370028775046 3.273371744307053 -2.5732411224128926 0.6312079172129632 1.8751555199619339 -0.01904707971794517 2.07687200659789 3.4062299515579535 -3.622359224528262 3.9590408547718083 0.8841604539960034 -2.214924992529375 3.193134476778507 -1.8143609265716782 -2.5025855941040396 0.1156412919653087 3.07448885408457 1.6615299243431187 3.837087176704965 0.25297824402982716 2.4669001335551783 -1.694000376478534 -0.023176161175570753 2.967789074494794 2.013479924438876] [4.1872486524702675 1.7107363759765035 3.0783409154616495 -0.2686986401554967 0.3476073540276753 1.185957221721409 0.3584576858191624 2.633473779831384 -4.744083340467182 1.6758776140078382 3.126074083292678 0.5212802167180166 1.132004779563826 3.0194878468129636 -1.5179620125515658 1.7556049708853798 1.445415931162815 -0.7799462606512184 -0.9570430116427109 -0.953060620046396 3.357612187062366 5.085992785248521 2.7316741843598065 0.4406266126653894 3.0343699749702173] [3.8131726102654873 1.8047712972748786 2.8035452680393504 2.625233599225006 0.15618334643800036 1.143613805168392 0.6958731652207759 -1.2038995266309063 2.8215621671871665 -0.5677106075483167 3.294540127286482 2.0495082060112666 -2.6798267580707518 0.741034411247016 2.880376334859311 2.411628329454556 3.209141485747534 1.3287772753680211 0.9113572213631428 1.4739252910561802 0.6850678261760339 -0.8655976478047416 2.0009655127466703 -2.766407118463257 -0.6345510797405656] [-1.1534552956255624 -0.09349678506288073 -0.28144869834529884 0.8723641702814762 1.74793881470936 -2.3721115013415157 0.47542653402390267 0.7589354907731503 1.6550581467241738 0.2787523884296246 1.0054070590375865 0.14108936629673763 0.842897361261477 0.2843834935374566 -1.1111815803206957 4.162843267217 -2.9381376946988516 2.758779714842225 1.611912877956547 5.004709276023564 0.8756596042665674 0.785929877038927 0.7304716009463192 2.3894930165969868 0.8217495339847712] [1.0783258146702908 4.201897247020204 2.131761258419715 -0.28600176295590374 2.503584134965961 1.2085838017317052 2.807859469869137 -3.1027219897101075 1.9546230290266955 -2.160805602410069 -3.4368184259697783 -0.4955342310064943 3.307829595484943 0.1231270165453906 0.6120471613036715 1.0811245362461497 1.3669258107496356 2.3482152423055513 1.8101194170534267 -0.13975412820280875 3.0890132779618598 1.077291918848677 0.6865755823035209 -0.4005961043727513 -4.415437824532393] [2.2712554894469097 -1.6679748384289748 3.115858760970032 0.6413894875166428 2.119009975139213 0.045919453882692585 -0.34295869764960885 -1.5057449967701864 4.800959673639632 0.40190277361841054 0.7258160065881105 4.802186671581715 1.3862582077353829 -1.0795376247567705 -1.0412368026051602 2.911982450521651 -3.0782175169839494 1.9637418966933358 3.5527829938114928 0.2845521083828675 3.800822029883871 5.672386714000826 1.758819958008335 0.9553696028041361 -0.22633312445448728] [0.3049509878259137 -2.271444839968683 -0.2586094930669469 2.673559803551395 2.054491627611357 0.3450211190901721 2.7205866588622882 -1.2605397323785819 -2.926136392301407 -2.0682712579704567 -1.5952292081468715 0.11588397139440842 2.4464559315866063 1.5387446688874196 1.9058310958198494 -0.8203573243710407 0.9114553795226391 1.5664970698938956 3.4629483222425153 -1.8590574391017975 2.1120126030735644 -2.1383485928520294 6.04345145209989 4.166792559515094 0.630675580379024] [-1.179810133408735 0.5814987159515311 3.0495586167822655 2.7645435012989514 1.7630894064903777 1.7873885521874782 -1.275487760761349 0.9899973541996955 -2.081198510725298 0.5375438279507687 0.5765776694406133 1.0135608677037093 0.471538582019823 -1.5384991547564733 1.9446131445233374 -1.5458686558062036 0.6357161950175554 -0.5801200677569898 -0.07244575237795492 0.6549058612069691 1.7163585609109484 1.0913918249631944 -1.976968913834495 -3.4711986469849823 0.2806331046906173] [2.57225612183145 -0.7446996634953285 -0.6377548864398797 2.3013294375354403 -0.7634320792660563 -1.2612352074388276 4.6261303647879695 0.24666597751504715 -1.3426471037737535 3.6520263322395645 -0.5078029983159063 1.5900206220894406 2.4929080519554194 0.2983371199695124 3.391058478962029 -0.20791103468398764 3.6345112404536573 0.8412704744765311 3.1000719701956503 2.5377184101675274 1.6213060729874118 -1.1862953701186005 0.711249408865427 2.077577255761445 2.8389247787497682] [2.962530016027789 3.328943200305688 2.683657964541182 1.608404356219916 1.8117379421015496 -1.302170532162854 1.3843870129237494 -0.5757782175606405 -0.2844986334356465 -0.7697693158072947 -0.49556574306414514 -0.8425542331175047 3.0218636822567198 0.31900217390206864 2.3585712672427146 3.0297418083074854 4.8696267398721815 0.8106756431324573 1.3860272268881033 1.2926951152207262 0.3643055306435329 1.1978452218775664 -0.011838949120857922 3.37063946226989 -1.507614711846998] [2.3886471186168086 2.2486773680552377 2.950720404544469 4.917713302279533 0.4230769741065138 2.0977222284218566 -0.14634788689139455 1.0500898322060181 3.3136015538565373 0.2889098811757571 2.865342681270758 -1.4638330013394127 2.8308654954440393 0.11905888767194461 2.5714557041345687 1.1884606412274121 0.47501138757668626 0.6671745053645795 0.3233334490265801 2.054275648728632 4.239447056151834 1.4202993257799676 -3.1803729926046413 0.4907498598561494 -2.2454272804910738] [-0.8589627990148054 -1.6370604867679566 -0.0013366652468789209 0.6567373787687207 3.0522852644577587 2.1555757766089494 -1.9722038989916575 2.1970306273709257 -1.217033513757051 -2.498198407185456 3.1916443301880015 0.48867770628378326 2.9050086493436407 -0.15107800479309375 -0.40515709065093897 3.6341885005650507 4.9436805970446684 0.4153064165190664 3.5330500045809314 3.600790111167231 0.4061245936540594 -0.17291925951429765 -1.6170134782907786 -0.6218252296564397 2.47408527329468] [0.49003099893026614 -0.513646432487272 -0.011308563346881684 2.888853130329305 0.21868252449812076 -4.132281865722772 1.3214054878889456 3.54576276453366 1.9839631659284942 -0.26803336083017415 2.9009035152645177 0.5407684750164162 2.8809271279679347 0.06697688416722569 0.8015120734380803 0.5230451160506777 2.828745736157675 0.14038824261985972 1.8807209001534644 -0.7288105283496225 -1.414392673067368 -1.965876869656776 -2.2784223832833095 -0.3213605890983102 2.591979608276785] [0.6032146680919144 2.6154351694806977 -2.611180665008552 3.7126205332660676 1.8841664686957118 -2.599589291880361 2.6471584583203116 -0.3524025507369237 2.542792171828953 0.07241249763708524 -1.1018393150278283 2.8496967335251444 2.5129389763234675 2.7453092785313267 1.1371017084433817 2.4380652894184394 0.6538767343774998 -2.0344352632417575 1.4478324822360777 -0.5178311372900186 1.3778264651838275 0.6485561193664495 2.1309412437604127 1.3732557992144439 1.0109132626082427] [-9.093636453629816E-4 0.8392071645805256 1.9613900852705841 1.2355628498932083 2.9284840858037287 1.3949820915383806 3.547512673950172 1.881074475176438 -1.6938646101822972 0.033671122442757606 -1.6983463372706211 0.5614618963678546 -5.384842685320887 1.5874313374585505 1.404896961885934 1.1999826416937522 2.5218030230095767 3.338075281188799 -0.9184054473813776 -1.563761708419651 2.5170017619021783 2.0459269981477064 -4.139941057649177 4.334583861193162 2.91502121002457] [-0.4183975745351325 -2.1180493379830883 1.9908023657588965 -0.27710147493620707 -2.97030001360622 -0.6174229739612263 -2.8310976031504307 2.2070834645093464 2.407988891851377 -0.4581720561595961 -2.46286643764576 2.312117406254602 5.4628545328590254 4.224815951004489 -0.008707332278539592 -3.186421318700253 2.2982838757110167 -0.49867466043109343 -1.7851603349609562 -0.024808232051901857 0.013217320322761239 0.4606200219097061 2.500913712374768 2.7890651765863357 1.9785230672819958] [3.8894643470274586 2.6272214174560573 1.6429244035343138 0.25438692633801285 5.862882152280326 1.671959084009444 1.9481797541438266 2.1511187721570426 -1.3109633890295762 1.0244043033820271 -0.3430465842237562 1.2789362448456525 0.29456465094739526 -3.2796055326557036 0.2421399840772187 -0.9435875196345374 -1.488157532474664 -0.7274984261404651 0.38429266486247304 2.0759985925108513 0.6412994343691334 -1.4735402839295966 -0.1388700999160446 4.281852096156454 1.0873576635300766] [0.6919036922619214 1.8776616037336766 3.413074188653072 0.6231900247335803 2.116067900028175 2.0141639693140263 -1.2707224266941606 2.2581154176518043 1.2918778124805763 0.9477422888024388 0.08048132075442649 -3.9831479685195434 2.858065495903737 4.230625050057558 1.24509567302453 -0.6052432070440872 0.48927778321278015 3.4438659618065497 4.6561713665387 0.9113720556982912 2.1919907967749506 -0.23566182588824125 0.44771848498271927 2.3893852763038783 1.1092625968575422] [1.4672869457089948 1.9685109726793755 -4.677083334675617 2.5889005318696685 1.4077747631347612 3.700525892690921 2.336361184478184 -1.6702948252354184 6.450146948899145 1.1017029529181352 1.5723328480119725 3.636686261304726 -0.39458749139516036 -1.5470375022209537 2.809243227414637 2.3723426125157516 0.11210992499340189 3.9342656257113204 2.9164749781403416 -3.1473694710584397 0.06055155749468 1.001943969329792 3.695158911479363 -0.05724111699998313 -0.45827760914040283] [3.9322965599677326 3.6490731495144533 -1.1414281105554456 2.2407949687576867 0.4372429887221888 0.4372269323737584 0.030245013253268005 -2.245034600133775 1.196703894341023 -0.5036577212132067 4.785996515285058 -1.5448407804362643 -3.2856235121865005 0.3492113164133923 0.1570136791256801 0.5606851881711181 1.9203094542492822 1.2009325013609478 0.3031207368815848 3.093588112855949 0.9730698802459073 1.3018620476079463 -2.1330331319454556 1.1106343903295646 0.10075282585432888] [-1.895853699681692 1.4681537890910812 1.6677045272884392 1.520443110437673 1.5262124584800425 -0.1754834024576537 -2.872754104001129 0.9173691418175381 2.5153951364491167 0.07439290216326888 -0.09080089291936422 0.6881445621398056 0.4905214568242804 0.5104771447465839 1.0143971558097347 0.900868486593216 1.0174536355066077 1.1124343606887295 3.8930011878528377 3.7345173650525667 2.0350884232114455 -1.2087446025224113 -2.025986207090743 -0.6393732969667629 5.619139199023525]]], :kernel_vec [[0.06136742825073804 0.08345843347451545 0.01037501065368579 -0.09297615017252842 0.08684138013880618 0.0777032268839597 -0.04808500756284137 0.03702295982366525 0.06791564053795165 0.027420377907185656 0.029548992540841347 -0.09112960081549809 0.05637660267413119 0.04547288851407813 0.007306777442710841 -0.006349174602458138 -0.06163026899003643 -0.08966169731044929 0.09193178524360207 0.01523973884053588 0.014814645449546707 -0.09489934105454942 -0.08340591185094887 -0.0802196535676526 -0.07940805955074076] [-0.018036830834802314 0.04917323792633466 0.034988887213313606 -0.00622079578717602 0.0357564694412206 -0.022371923161519328 0.09597909498517251 -0.02731448676063781 0.09276000902478754 0.010407408546108943 -0.00988000504160981 0.01393883997388995 -0.09534576741517986 -0.0024712764557595496 -0.04650765585028951 0.06131366916973163 -0.029781418900013595 0.07814671470205048 -0.015558064264662205 -0.051046024468364426 0.06543165647546043 0.07493290232206273 -0.01778900194991752 -0.046427618219296175 0.036773974513441554] [-0.023569533249615443 0.09662974655867526 -0.07449832910313339 0.026269819590719015 -0.0398200749591833 0.08475265533332518 -0.05826972627213498 0.03469634775435205 0.09438899094398637 -0.03160985727486925 0.08960926015013182 -0.051790995879406894 0.029927827052527826 0.03428748630836672 -0.017212493724013275 0.03245220456386252 0.07470306343464966 0.008415804874309207 0.08068679513412838 -0.0416075218439948 -0.05364506292081714 0.05206223177136322 -0.005481991319706919 -0.05998239698803998 0.029302890069111187] [-0.039626991149801866 -0.003739366616848469 0.08821759804760318 -0.02584440003139213 -0.03130329604977802 -0.05370875344638612 -1.2473331571795365E-4 -0.021460260874234707 0.0768346524540757 -0.023718819747334544 0.03264568817163304 0.02580323955497521 -0.08190894596197545 -0.07817356834444156 -0.060378642707623796 -0.04927065684291737 0.0017998089241773874 -0.026012117512941774 -0.027613512874057916 -0.07571019014645378 0.09075187063770027 0.07848023384462527 0.025797618804247524 -0.0058551576065680455 0.06542614513366213]]})
;; @@

;; @@
(defn inverse-factor-vec [model]
  (let [num_cluster (:num_cluster model)
        pi (:pi model)
        mu_vec (:mu_vec model)
        factor_vec (:factor_vec model)
        ischild_vec (:ischild_vec model)
        child_vec (:child_vec model)
        kernel_vec (:kernel_vec model)
        inversed-factor-vec (map clojure.core.matrix/inverse factor_vec)
        inversed-child-vec (map (fn [index] 
                                    (if (= 1 (nth ischild_vec index)) 
                                      (inverse-factor-vec (nth child_vec index))
                                      (nth child_vec index))) (range 0 num_cluster))]
    {:num_cluster num_cluster, :pi pi, :mu_vec mu_vec, :factor_vec inversed-factor-vec, :ischild_vec ischild_vec, :child_vec inversed-child-vec, :kernel_vec  kernel_vec}
    	)
  )
;; @@

;; @@
(def inverse-model (inverse-factor-vec result-model))
;; @@

;; @@
(defn for-images-deer-1 [file-name iter-num do-fun]
  "Read file-name, to 32*32 images, and for each image, apply do-fun. It will perform do-fun for n images."
  (let [f (java.io.File. file-name)
		  st (byte-streams/to-byte-array f)]
    (loop [chunk (partition 3073 st) n iter-num]
      (let [ch (first chunk)
            deerclassifier (first ch)
            firstarray (next ch)
            image (mikera.image.core/new-image 32 32)
            pixels (mikera.image.core/get-pixels image)]
        (if (not= deerclassifier 4) (recur (next chunk) n)
          (do 
            (loop [i 0 j 0]
              (if (= j 32)
                (do-fun n image)
                (if (= i 32)
                  (recur 0 (+ j 1))
                  (do
                    (mikera.image.core/set-pixel image i j (mikera.image.colours/rgb-from-components
                                                             (sb2ub (nth firstarray (+ i (* 32 j))))
                                                             (sb2ub (nth firstarray (+ 1024 (+ i (* 32 j)))))
                                                             (sb2ub (nth firstarray (+ 2048 (+ i (* 32 j)))))))
                    (recur (+ i 1) j)
                    )
                  )
                )
              ) 
              (when (> n 1) (recur (next chunk) (- n 1)))
              )
            )
          )
        )
      )
    )
;; @@

;; @@
(defn get-restore-result [n image]
  (let [gray (grayscaled image)
        drop (dropoutted-normal gray 0.2)
        restore (restore drop inverse-model 2 {:feeder "best", :is-single true})
        original (clojure.string/replace "data/deer/asb/orginal_auto-single-best_num.png" "num" (str n))
        grayed (clojure.string/replace "data/deer/asb/gray_auto-single-best_num.png" "num" (str n))
        dropped (clojure.string/replace "data/deer/asb/drop_auto-single-best_num.png" "num" (str n))
        restored (clojure.string/replace "data/deer/asb/restore_single-best_num.png" "num" (str n))]
    
  (mikera.image.core/save image original)
  (mikera.image.core/save gray grayed)
  (mikera.image.core/save drop dropped)
  (mikera.image.core/save restore restored)
  (println (peak-signal-to-noise-ratio gray drop))
  (println (peak-signal-to-noise-ratio gray restore)
    )
  ))
;; @@

;; @@
(for-images-deer-1 "data/cifar-10-batches-bin/data_batch_2.bin" 10 get-restore-result)
;; @@

;; @@
(def signals [13.948668153247548
17.539146179058072
16.438948819573415
17.421720349965643
15.808021198372405
17.57990344649223
16.408392758079785
17.543445162405888
12.730547178444509
19.524125467890396
11.309198543631247
16.847893435024474
11.62591748676869
15.524091005186712
14.412607502884182
16.65730773876892
14.55971650612609
19.072001923907223
14.272407990337275
18.495087941683114])
;; @@

;; @@
(loop [n 0 old 0 new 0]
  (if (= n 10)
    [(/ old n) (/ new n)]
    (recur (+ 1 n) (+ old (nth signals (* 2 n))) (+ new (nth signals (+ (* 2 n ) 1))))))
;; @@
